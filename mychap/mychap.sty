\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{mychap}
\RequirePackage{titlesec}
\RequirePackage{lastpage}
\RequirePackage{fancyhdr}
\RequirePackage{svg}

\newif\ifstage
\DeclareOption{stage}{\stagetrue}
\ProcessOptions\relax

\ifstage
  \fancyhead[R]{\includesvg{./Annexe/Logos/_entreprise.svg}}
  \fancyhead[L]{\includesvg{/Users/es_tk_/Documents/ENSEM/Logos/UL & ENSEM.svg}}
\else
  \fancyhead[L]{\includesvg{/Users/es_tk_/Documents/ENSEM/Logos/UL.svg}}
  \fancyhead[R]{\includesvg{/Users/es_tk_/Documents/ENSEM/Logos/ENSEM.svg}}
\fi

\fancypagestyle{plain}{
  \fancyhf{}
  \renewcommand\footrulewidth{0.4pt}
  \renewcommand\headrulewidth{0.4pt}
  
  \ifstage
    \fancyhead[L]{\includesvg{/Users/es_tk_/Documents/ENSEM/Logos/UL & ENSEM.svg}}
    \fancyhead[R]{\includesvg{./Annexe/Logos/_entreprise.svg}}
  \else
    \fancyhead[L]{\includesvg{/Users/es_tk_/Documents/ENSEM/Logos/UL.svg}}
    \fancyhead[R]{\includesvg{/Users/es_tk_/Documents/ENSEM/Logos/ENSEM.svg}}
  \fi

  \fancyfoot[L]{\fontspec{Cinzel Decorative}\MyAuthor}
  \fancyfoot[R]{\textit{\MyTitle}}
  \fancyfoot[C]{\textit{\thepage/\pageref*{LastPage}}}
}

\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries}{\chaptertitlename \thechapter}{20pt}{\Huge}[\minitoc \newpage]

\titleformat{name=\chapter,numberless}[display]
  {\normalfont\huge\bfseries}{}{20pt}{\Huge}